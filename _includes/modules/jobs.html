{%- assign iframe_src = "/apps/gym/geolocator" | prepend: site.aqassetsurl -%}
{%- if jekyll.environment == "local" -%}
  {%- assign iframe_src = "?gymdev=true" | prepend: iframe_src -%}
{%- endif -%}

{%- assign markets_au = site.data.markets-au.contentlets -%}
{%- assign markets_ca = site.data.markets-ca.contentlets -%}
{%- assign markets_de = site.data.markets-de.contentlets -%}
{%- assign markets_fr = site.data.markets-fr.contentlets -%}
{%- assign markets_jp = site.data.markets-jp.contentlets -%}
{%- assign markets_nl = site.data.markets-nl.contentlets -%}
{%- assign markets_uk = site.data.markets-uk.contentlets -%}
{%- assign markets_us = site.data.markets-us.contentlets -%}


{%- unless jobs_module_class -%}
  {%- assign jobs_module_class = "default" -%}
{%- endunless -%}

{%- unless opt_heading -%}
  {%- assign opt_heading = "h3" -%}
{%- endunless -%}

{%- unless opt_category -%}
  {%- assign opt_category = "false" -%}
{%- endunless -%}

{%- unless opt_limit -%}
  {%- assign opt_limit = 10 -%}
{%- endunless -%}

<link rel="stylesheet" href="{{ site.url }}/css/jobs.css">

<form id="location" class="location" action="{{page.permalink}}">
  <input type="hidden" name="submitted" value="true">
  <select name="m" id="m" class="form-control" onchange="this.form.submit();">
    <option value="">Select a location nearest you</option>
    <option value="remote">Remote</option>
    <optgroup label="Australia">
      {%- for market in markets_au -%}
        <option value="{{market.marketId}}">{{market.name}}</option>
      {%- endfor -%}
    </optgroup>
    <optgroup label="Canada">
      {%- for market in markets_ca -%}
        <option value="{{market.marketId}}">{{market.name}}</option>
      {%- endfor -%}
    </optgroup>
    <optgroup label="Europe">
      {%- for market in markets_uk -%}
        <option value="{{market.marketId}}">{{market.name}}</option>
      {%- endfor -%}
      {%- for market in markets_nl -%}
        <option value="{{market.marketId}}">{{market.name}}</option>
      {%- endfor -%}
      {%- for market in markets_fr -%}
        <option value="{{market.marketId}}">{{market.name}}</option>
      {%- endfor -%}
    </optgroup>
    <optgroup label="Japan">
      {%- for market in markets_jp -%}
        <option value="{{market.marketId}}">{{market.name}}</option>
      {%- endfor -%}
    </optgroup>
    <optgroup label="United States">
      {%- for market in markets_us -%}
        <option value="{{market.marketId}}">{{market.name}}</option>
      {%- endfor -%}
    </optgroup>
  </select>
</form>
<div id="messages">
  <div id="loading" class="loading">
    <p>Please wait while we find you some jobsâ€¦</p>
  </div>
  <div id="error-results" class="hide">
    <h4>Ooops!</h4>
    <p>We were unable to find jobs for this location. Please try another location, or come back later to check for freshly posted jobs.</p>
  </div>
  <div id="error-server" class="hide">
    <h4>Ooops!</h4>
    <p>We were unable to retrieve jobs due to a server error. Please try again later.</p>
  </div>
  <div id="error-connection" class="hide">
    <h4>Ooops!</h4>
    <p>The hamsters running this wheel were conspicuously absent. As a result, your request fell on deaf ears. Please try again later.</p>
  </div>
</div>
<div id="jobs" class="jobs {{jobs_module_class}}" data-options="heading:{{opt_heading}};category:{{opt_category}};limit:{{opt_limit}}"></div><!-- #jobs.jobs.{{jobs_module_class}} -->
<iframe id="geolocator" src="{{ iframe_src }}" frameborder="0" style="width:1px;height:1px;visibility:hidden;"></iframe>

<script async defer src="{{site.url}}/js/jobs.js"></script>
